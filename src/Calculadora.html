<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Calculadora de Lógica Proposicional</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f0f2f5;
            display: flex;
            justify-content: center;
            padding: 50px 0;
        }
        .container {
            display: flex;
            gap: 30px;
            justify-content: center;
            align-items: flex-start;
        }
        .calculadora {
            background: #34495e;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            width: 320px;
        }
        .display {
            width: 100%;
            height: 50px;
            font-size: 20px;
            margin-bottom: 15px;
            text-align: right;
            padding-right: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
        }
        .botoes {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }
        .botoes button {
            padding: 12px 0;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
            color: #fff;
        }
        .letra { background-color: #bdc3c7; color: #2c3e50; }
        .operador-btn { background-color: #7f8c8d; color: #ecf0f1; }
        .igual { background-color: #27ae60; }
        .limpar { background-color: #c0392b; }
        .botoes button:hover { filter: brightness(1.1); }
        #resultado { min-width: 400px; }
        .tabela { border-collapse: collapse; width: 100%; }
        .tabela th, .tabela td { border: 1px solid #000; padding: 8px; text-align: center; }
    </style>
</head>
<body>
<div class="container">
    <div class="calculadora">
        <input type="text" id="expressao" class="display">
        <div class="botoes">
            <script>
                const letras = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split('');
                letras.forEach(l => {
                    document.write(`<button class="letra" onclick="inserir('${l}')">${l}</button>`);
                });
            </script>
            <button class="operador-btn" onclick="inserir('¬')">¬</button>
            <button class="operador-btn" onclick="inserir('∧')">∧</button>
            <button class="operador-btn" onclick="inserir('∨')">∨</button>
            <button class="operador-btn" onclick="inserir('⊕')">⊕</button>
            <button class="operador-btn" onclick="inserir('→')">→</button>
            <button class="operador-btn" onclick="inserir('↔')">↔</button>
            <button class="operador-btn" onclick="inserir('(')">(</button>
            <button class="operador-btn" onclick="inserir(')')">)</button>
            <button class="limpar" onclick="limpar()">C</button>
            <button class="limpar" onclick="apagar()">DEL</button>
            <button class="igual" style="grid-column: span 2;" onclick="calcular()">=</button>
        </div>
    </div>
    <div id="resultado"></div>
</div>

<script>
    const operadores = {
        "¬": (p) => !p,
        "∧": (p,q) => p&&q,
        "∨": (p,q) => p||q,
        "⊕": (p,q) => p!==q,
        "→": (p,q) => !p||q,
        "↔": (p,q) => p===q
    };

    function inserir(valor) { document.getElementById("expressao").value += valor; }
    function apagar() { const display = document.getElementById("expressao"); display.value = display.value.slice(0,-1); }
    function limpar() { document.getElementById("expressao").value = ""; document.getElementById("resultado").innerHTML = ""; }

    function calcular() {
        const formula = document.getElementById("expressao").value.trim();
        const resultadoDiv = document.getElementById("resultado");
        try {
            let variaveis = [...new Set(formula.replace(/[^A-Z]/g,'').split(''))];
            if(variaveis.length===0) throw "Fórmula inválida.";
            variaveis.sort();
            const combinacoes = gerarCombinacoes(variaveis.length);
            const tabela = avaliarTabela(formula, variaveis, combinacoes);
            let htmlTabela = renderizarTabela(variaveis,tabela);
            const classificacao = classificarTabela(tabela);
            htmlTabela += `<p><strong>Classificação:</strong> ${classificacao}</p>`;
            resultadoDiv.innerHTML = htmlTabela;
        } catch(erro) {
            resultadoDiv.innerHTML = `<p style="color:red;">Erro: ${erro}</p>`;
        }
    }

    function gerarCombinacoes(n){
        const linhas=[];
        for(let i=0;i<(1<<n);i++){
            const linha = [];
            for(let j=0;j<n;j++){
                linha.push(Boolean((1 << (n-j-1)) & i));
            }
            linhas.push(linha);
        }
        linhas.forEach(linha => linha.forEach((v,i)=>linha[i]=!v));
        return linhas;
    }

    function avaliarTabela(formula,variaveis,combinacoes){
        return combinacoes.map(linha=>{
            const contexto = Object.fromEntries(variaveis.map((v,i)=>[v,linha[i]]));
            return [linha, avaliarExpressao(formula,contexto)];
        });
    }

    function avaliarExpressao(expr, contexto){
        let interpretada = expr.replace(/[A-Z]/g,m=>contexto[m]?'true':'false');
        const pilhaValores=[];
        const pilhaOperadores=[];
        const prioridade={'¬':5,'∧':4,'∨':3,'⊕':2,'→':1,'↔':0};

        const aplicarOperador=()=> {
            const op = pilhaOperadores.pop();
            if(op==='¬'){ const p=pilhaValores.pop(); pilhaValores.push(operadores[op](p)); }
            else { const q=pilhaValores.pop(); const p=pilhaValores.pop(); pilhaValores.push(operadores[op](p,q)); }
        };

        for(let i=0;i<interpretada.length;i++){
            const char=interpretada[i];
            if(char==='t'||char==='f'){ pilhaValores.push(char==='t'); i+=char==='t'?3:4; }
            else if(char==='(') pilhaOperadores.push(char);
            else if(char===')'){ while(pilhaOperadores.length && pilhaOperadores[pilhaOperadores.length-1]!=='(') aplicarOperador(); pilhaOperadores.pop(); }
            else if(char in operadores){
                while(pilhaOperadores.length && prioridade[char]<=prioridade[pilhaOperadores[pilhaOperadores.length-1]]) aplicarOperador();
                pilhaOperadores.push(char);
            }
        }
        while(pilhaOperadores.length) aplicarOperador();
        return pilhaValores.pop();
    }

    function renderizarTabela(variaveis,tabela){
        let html='<table class="tabela"><tr>'+variaveis.map(v=>`<th>${v}</th>`).join('')+'<th>Resultado</th></tr>';
        tabela.forEach(([linha,resultado])=>{
            html+='<tr>'+linha.map(v=>`<td>${v?'V':'F'}</td>`).join('')+`<td>${resultado?'V':'F'}</td></tr>`;
        });
        html+='</table>';
        return html;
    }

    function classificarTabela(tabela){
        const resultados=tabela.map(([,res])=>res);
        if(resultados.every(r=>r)) return "Tautologia";
        if(resultados.every(r=>!r)) return "Contradição";
        return "Contingência";
    }
</script>
</body>
</html>